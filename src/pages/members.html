<head>
    <title>Malang | Associates</title>
    <link rel="stylesheet" href="../styles/common.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script type="module" src="https://cdn.jsdelivr.net/npm/ldrs/dist/auto/ring2.js"></script>
    <style>
        h2{
            text-align: center;
        }
        .styled-table {
            width: 100%;
            border-collapse: collapse;
            border-spacing: 0;
            border-radius: 7px;
            overflow: hidden;
            text-align: center;
            margin-bottom: 10px;
        }

        .styled-table th,
        .styled-table td {
            padding: 5px;
            border: 1px solid #383838;
            text-align: left;
            white-space: nowrap;
        }

        .styled-table th {
            background: #1b1b1b;
        }

        .styled-table tr:nth-child(even) {
            background: #0f0f0f;
        }

        .styled-table tr:hover {
            background: rgb(25, 21, 0);
            color: rgb(255, 214, 0);
        }

        .table-wrapper {
            overflow-x: auto;
            width: calc(100vw - 20px);
            border-radius: 7px;
            margin: 10px;
        }

        #csv-table {
            width: 100%;
        }
    </style>
</head>

<body>
    <section>
        <div id="loader">
            <l-ring-2 size="25" stroke="2" stroke-length="0.25" bg-opacity="0.1" speed="0.8" color="white"></l-ring-2>
        </div>
        <h2>Malang Associates</h2>
        <div class="table-wrapper">
            <table id="csv-table" class="styled-table" style="margin: 70px 10x;"></table>
        </div>
    </section>
</body>

<script>
    const url = "https://raw.githubusercontent.com/MalangBvp/media/f50749861653e264c0e2e1fe33a7920cedd16d87/members.csv"

    const columnsToShow = ["Name", "Position", "Year", "Branch", "Division", "Socials Media Handles"]

    fetch(url)
        .then(res => res.text())
        .then(csv => {
            const rows = csv.trim().split("\n").map(r => r.split(","))

            const header = rows[0]
            const data = rows.slice(7)

            const colIndexes = columnsToShow.map(c => header.indexOf(c))

            const table = document.getElementById("csv-table")

            // Add Sr. No. column
            let thead =
                "<tr><th>Sr. No.</th>" +
                columnsToShow.map(c => `<th>${c}</th>`).join("") +
                "</tr>"

            let tbody = data
                .map((row, index) =>
                    "<tr>" +
                    `<td>${index + 1}</td>` +
                    colIndexes.map(i => `<td>${row[i] || ""}</td>`).join("") +
                    "</tr>"
                )
                .join("")

            table.innerHTML = thead + tbody
            document.getElementById("loader").style.display = "none"
        })
</script>